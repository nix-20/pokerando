<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Monopoly Poker Style - Smart Bots</title>
<style>
body { background-color: #1b5e20; font-family: Arial, sans-serif; display:flex; justify-content:center; align-items:center; height:100vh; color:white;}
#table { background-color: #2e7d32; padding:20px; border-radius:20px; width:750px; text-align:center; box-shadow:0 0 20px black;}
.cards, #community-cards { display:flex; justify-content:center; gap:10px; margin:10px 0;}
.card { width:50px; height:70px; background-color:white; color:black; display:flex; justify-content:center; align-items:center; font-weight:bold; border-radius:5px;}
button { margin:5px; background-color:#ffeb3b; border:none; padding:10px 15px; font-weight:bold; cursor:pointer; border-radius:10px;}
button:hover { background-color:#fdd835;}
input { width:60px; padding:5px; font-weight:bold; border-radius:5px; border:none; text-align:center;}
.info { margin-top:5px;}
</style>
</head>
<body>
<div id="table">
    <h2>Monopoly Poker Style</h2>
    <div id="community-cards" class="cards"></div>
    <div id="pot">Piatto: $0</div>
    <div id="player-info" class="info">Tu: $1000</div>
    <div id="player-cards" class="cards"></div>
    <div>
        <input type="number" id="bet-amount" placeholder="Punta">
        <button onclick="playerBet()">Bet</button>
        <button onclick="playerCheck()">Check</button>
        <button onclick="playerFold()">Lascia</button>
    </div>
    <div id="bot-info" class="info">Bot: $1000</div>
</div>

<script>
const suits = ["♠","♥","♦","♣"];
const values = ["2","3","4","5","6","7","8","9","10","J","Q","K","A"];
let deck = [], playerCards = [], botCards = [], communityCards = [];
let pot=0, playerMoney=1000, botMoney=1000, currentBet=0;
let phase=0; //0=preflop,1=flop,2=turn,3=river,4=showdown

function createDeck() { deck=[]; for(let s of suits) for(let v of values) deck.push(v+s);}
function shuffleDeck(){ for(let i=deck.length-1;i>0;i--){let j=Math.floor(Math.random()*(i+1));[deck[i],deck[j]]=[deck[j],deck[i]];} }
function dealCards(){ playerCards=[deck.pop(),deck.pop()]; botCards=[deck.pop(),deck.pop()]; communityCards=[]; currentBet=0; pot=0; phase=0; updateUI(); }
function updateUI(){ const p=document.getElementById("player-cards"); p.innerHTML=""; for(let c of playerCards){ const d=document.createElement("div"); d.className="card"; d.textContent=c; p.appendChild(d);}
const com=document.getElementById("community-cards"); com.innerHTML=""; for(let c of communityCards){ const d=document.createElement("div"); d.className="card"; d.textContent=c; com.appendChild(d);}
document.getElementById("pot").textContent="Piatto: $"+pot;
document.getElementById("player-info").textContent="Tu: $"+playerMoney;
document.getElementById("bot-info").textContent="Bot: $"+botMoney;}

function getCardValue(c){ let v=c.slice(0,-1); if(v=="J") return 11; if(v=="Q") return 12; if(v=="K") return 13; if(v=="A") return 14; return parseInt(v);}
function evaluateHand(cards){ return cards.reduce((sum,c)=>sum+getCardValue(c),0); }

function botAction(){
    if(botMoney<=0) return;
    let allCards=botCards.concat(communityCards);
    let score=evaluateHand(allCards);
    let decision="";
    let rand=Math.random();
    if(score<30 && rand<0.4){ decision="fold"; } 
    else if(score>=30 && score<50){ decision=(rand<0.5)?"call":"raise"; } 
    else{ decision=(rand<0.7)?"raise":"call"; }
    if(rand<0.1) decision="raise"; // bluff casuale
    if(decision=="fold"){ alert("Bot lascia"); playerMoney+=pot; endRound(); return; }
    else if(decision=="call"){ let callAmount=Math.min(currentBet,botMoney); pot+=callAmount; botMoney-=callAmount; alert("Bot chiama $"+callAmount); }
    else if(decision=="raise"){ let raiseAmount=Math.min(50,botMoney); pot+=raiseAmount; botMoney-=raiseAmount; currentBet+=raiseAmount; alert("Bot rilancia $"+raiseAmount); }
    updateUI();
}

function playerBet(){ let bet=parseInt(document.getElementById("bet-amount").value); if(isNaN(bet)||bet<=0||bet>playerMoney){ alert("Importo non valido"); return; } pot+=bet; playerMoney-=bet; currentBet=bet; document.getElementById("bet-amount").value=""; updateUI(); botAction(); nextPhase(); }
function playerCheck(){ botAction(); nextPhase(); }
function playerFold(){ alert("Hai lasciato la mano"); botMoney+=pot; endRound(); }

function nextPhase(){ phase++; if(phase===1) communityCards.push(deck.pop(),deck.pop(),deck.pop());
else if(phase===2) communityCards.push(deck.pop());
else if(phase===3) communityCards.push(deck.pop());
else if(phase===4) showdown(); updateUI(); }

function showdown(){
    alert("Showdown!\nTu: "+playerCards.join(", ")+"\nBot: "+botCards.join(", "));
    const playerScore=evaluateHand(playerCards.concat(communityCards));
    const botScore=evaluateHand(botCards.concat(communityCards));
    if(playerScore>botScore){ alert("Hai vinto!"); playerMoney+=pot; }
    else if(botScore>playerScore){ alert("Bot vince!"); botMoney+=pot; }
    else{ alert("Pareggio! Piatto diviso"); playerMoney+=pot/2; botMoney+=pot/2; }
    endRound();
}

function endRound(){ phase=0; createDeck(); shuffleDeck(); dealCards(); }

createDeck(); shuffleDeck(); dealCards();
</script>
</body>
</html>
